# WebAssembly Image Processor

This started as an assignment but turned into me trying to figure out if WASM is actually faster and how much faster it is than JS for image processing.

## Repository

**GitHub:** https://github.com/michaeltoddprogramming/WASMImageProcessor

Clone this repository to get all the source code and follow along with the tutorial.

## What it does

- Image filters (blur, brightness, contrast, grayscale)  
- JS vs WASM performance comparison
- Works in the browser

## What you need

You'll need:
1. Emscripten (to compile C++ to WASM)
2. Python or any other way to serve files locally 
3. A decent browser
4. Some patience because emscripten can be annoying

## Setup

### 1. Install Emscripten
Get emscripten from https://github.com/emscripten-core/emsdk

Windows:
```bash
# Download and extract emsdk to C:\tools\emsdk (or wherever)
# Open PowerShell as Administrator, navigate to emsdk folder
emsdk install latest
emsdk activate latest  
emsdk_env.bat
```

Linux/Mac:
```bash
git clone https://github.com/emscripten-core/emsdk.git
cd emsdk
./emsdk install latest
./emsdk activate latest
source ./emsdk_env.sh
```

Verify it worked: `emcc --version`

### 2. Build the WebAssembly Module

**Option A: Use the build script (recommended)**
```powershell
# In project directory
.\build.ps1
```

The script will:
- Check if emscripten is installed
- Compile the C++ code to WASM

**Option B: Manual compilation**
```bash
emcc imageprocessing.cpp -o imagefilters.js \
  -s "EXPORTED_FUNCTIONS=[\"_applyBlur\", \"_adjustBrightness\", \"_adjustContrast\", \"_grayscale\", \"_malloc\", \"_free\"]" \
  -s ALLOW_MEMORY_GROWTH=1 \
  -s MODULARIZE=0 \
  -s EXPORT_ES6=0 \
  -s ENVIRONMENT=web \
  -O3
```

### 3. Start a Local Server
```bash
# Python 3
python -m http.server 8000

# Or if you have Node.js
npx serve .

# Or PHP
php -S localhost:8000
```

### 4. Open in Browser
Navigate to http://localhost:8000 and you're good to go!

## How to use

Upload an image (or use the default), pick JS vs WASM, choose a filter, mess with the intensity slider and hit apply. The performance comparison shows up at the bottom.

## Files

- `imageprocessing.cpp` - the C++ code that does the actual work
- `app.js` - JS side of things + JS implementations for comparison  
- `index.html` - the web page
- `build.ps1` - builds everything
- `imagefilters.js` / `imagefilters.wasm` - generated by emscripten

## How it works

The WASM version allocates memory, copies image data over, processes it in C++, copies it back and frees the memory. It's faster because C++ is compiled and doesn't have JS overhead for all the pixel loops.

## Results 

WASM is usually 2-3x faster, sometimes more depending on the image size and filter. Blur with high radius really shows the difference.

## Issues I ran into

- Make sure you build first or the WASM option won't show up
- Serve from a server, don't just open the HTML file  
- Sometimes emscripten path gets messed up, just re-run emsdk_env.bat
- Big images can be slow, stick to reasonable sizes

## Could add later

- More filters (edge detection would be cool)
- SIMD support  
- Web workers to not block the UI
- Video processing

This was for IMY 320 but ended up being pretty useful for understanding how WASM works with JS.